# Feature: Dark Mode

## Summary

Добавление поддержки тёмной темы с возможностью переключения между светлой, тёмной и системной темой. Переключатель располагается в новом компоненте Header, который также содержит название приложения "NoteBox".

## Requirements (из интервью)

| Вопрос | Ответ |
|--------|-------|
| Способ переключения | Оба варианта: системная тема по умолчанию + ручной переключатель |
| Расположение переключателя | Новый Header над основным контентом |
| Визуальный элемент | Иконка солнце/луна |
| Логика переключения | Циклическое: светлая → тёмная → системная → светлая (3 состояния) |
| Сохранение между сессиями | Да (localStorage) |
| Тема по умолчанию | Системная (prefers-color-scheme) |
| Анимация переключения | Да (плавный переход) |
| Содержимое Header | Название "NoteBox" + переключатель темы |
| Название в Sidebar | Убрать (оставить только в Header) |

## Files to Create

1. `src/components/Header.vue` — новый компонент шапки с названием и переключателем темы
2. `src/composables/useTheme.ts` — composable для управления темой (состояние, localStorage, media query)

## Files to Modify

1. `src/App.vue` — добавить Header в layout, изменить структуру
2. `src/components/Sidebar.vue` — убрать заголовок "NoteBox"
3. `src/style.css` — добавить CSS transition для плавного переключения темы
4. `tailwind.config.js` — включить `darkMode: 'class'` для поддержки dark mode

## Implementation Approach

### 1. Настройка Tailwind для Dark Mode

В `tailwind.config.js` добавить:
```js
darkMode: 'class'
```

Это позволит использовать класс `dark` на элементе `<html>` для активации тёмной темы.

### 2. Composable useTheme

Создать `src/composables/useTheme.ts`:
- Тип `ThemeMode = 'light' | 'dark' | 'system'`
- Реактивное состояние `themeMode` (текущий выбор пользователя)
- Вычисляемое свойство `effectiveTheme` (реальная тема с учётом системных настроек)
- Функция `cycleTheme()` для переключения между тремя состояниями
- Функция `applyTheme()` для установки/удаления класса `dark` на `<html>`
- Слушатель `matchMedia('(prefers-color-scheme: dark)')` для реакции на изменение системной темы
- Сохранение/загрузка из localStorage (ключ: `notebox-theme`)

### 3. Компонент Header

Создать `src/components/Header.vue`:
- Фиксированная высота (например, `h-12` или `h-14`)
- Слева: название "NoteBox" (text-xl font-bold)
- Справа: иконка-кнопка переключателя темы
- Иконки:
  - Светлая тема: солнце (sun icon)
  - Тёмная тема: луна (moon icon)
  - Системная: компьютер/монитор (desktop icon)
- Tooltip с текущим состоянием при наведении

### 4. Стили для Dark Mode

В компонентах использовать классы Tailwind с префиксом `dark:`:
- Фоны: `bg-white dark:bg-gray-900`, `bg-gray-50 dark:bg-gray-800`
- Тексты: `text-gray-800 dark:text-gray-100`, `text-gray-500 dark:text-gray-400`
- Границы: `border-gray-200 dark:border-gray-700`
- Hover состояния: `hover:bg-gray-100 dark:hover:bg-gray-700`

### 5. Анимация переключения

В `src/style.css` добавить:
```css
* {
  transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
}
```

### 6. Обновление Layout

В `App.vue` изменить структуру:
```vue
<template>
  <div class="flex flex-col h-screen">
    <Header />
    <div class="flex flex-1 overflow-hidden">
      <Sidebar ... />
      <!-- остальной контент -->
    </div>
  </div>
</template>
```

## Components to Update with Dark Mode Classes

1. **App.vue** — корневой контейнер
2. **Sidebar.vue** — боковая панель, результаты поиска
3. **SearchBar.vue** — поле поиска
4. **FolderTree.vue** — дерево папок
5. **FolderItem.vue** — элемент папки
6. **NoteList.vue** — список заметок
7. **NoteEditor.vue** — редактор заметок
8. **EmptyState.vue** — пустое состояние
9. **ConfirmDialog.vue** — диалог подтверждения

## Acceptance Criteria

1. [ ] При первом посещении тема определяется по системным настройкам ОС
2. [ ] Клик по иконке циклически переключает: светлая → тёмная → системная
3. [ ] Выбранная тема сохраняется в localStorage и восстанавливается при перезагрузке
4. [ ] При режиме "системная" тема автоматически меняется при изменении настроек ОС
5. [ ] Все элементы UI корректно отображаются в обеих темах
6. [ ] Переключение темы происходит с плавной анимацией
7. [ ] Иконка переключателя отражает текущее состояние
8. [ ] Header отображает название "NoteBox" слева и переключатель справа
9. [ ] Название "NoteBox" убрано из Sidebar

## Edge Cases

1. **localStorage недоступен** — использовать системную тему как fallback, не сохранять
2. **prefers-color-scheme не поддерживается** — считать системную тему светлой
3. **Изменение системной темы в режиме "системная"** — автоматически применить новую тему
4. **Flash of incorrect theme при загрузке** — применить тему до рендеринга Vue (inline скрипт в index.html)

## Risks & Considerations

1. **FOUC (Flash of Unstyled Content)** — для предотвращения добавить inline скрипт в `<head>` в index.html, который применит класс `dark` до загрузки Vue
2. **Производительность** — CSS transition на `*` может влиять на производительность; можно ограничить конкретными свойствами
3. **Контрастность** — проверить, что цветовая схема обеспечивает достаточный контраст для доступности

## Out of Scope

- Кастомизация отдельных цветов пользователем
- Дополнительные темы помимо светлой и тёмной
- Синхронизация темы между устройствами
- Расписание автоматического переключения по времени суток
